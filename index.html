<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaturiTren√©r</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <div class="container">
            <nav class="navbar"> <!-- Changed div to nav -->
                <div class="logo">MaturiTren√©r</div>
                <div class="nav-links">
                    <a href="#" class="nav-link" id="dashboard-link">Dashboard</a>
                    <a href="#" class="nav-link" id="test-link">Testy</a>
                    <a href="#" class="nav-link" id="profile-link">Profil</a>
                    <a href="#" class="nav-link" id="auth-link">P≈ôihl√°sit se</a>
                    <button type="button" id="theme-toggle-btn" class="btn btn-sm"
                        title="P≈ôepnout svƒõtl√Ω/tmav√Ω re≈æim">üåô</button>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <section id="login-section" style="display: none;">
            <h1>P≈ôihl√°≈°en√≠ / Registrace</h1>
            <form id="login-form">
                <label for="nickname">P≈ôezd√≠vka:</label>
                <input type="text" id="nickname" required minlength="3" maxlength="15" pattern="[a-zA-Z0-9_]+">
                <small style="display: block; margin-bottom: 1rem; font-size: 0.8em; color: #718096;">(3-15 znak≈Ø, pouze
                    p√≠smena, ƒç√≠sla a podtr≈æ√≠tko)</small>
                <label for="email">Email:</label>
                <input type="email" id="email" required>

                <label for="password">Heslo:</label>
                <input type="password" id="password" required>

                <button type="button" id="login-btn" class="btn btn-primary">P≈ôihl√°sit se</button>
                <!-- Added classes -->
                <button type="button" id="register-btn" class="btn">Registrovat se</button> <!-- Added class -->
                <p id="login-message"></p>
            </form>
        </section>

        <section id="dashboard-section" style="display:none;">
            <h1>V√≠tejte v MaturiTren√©ru!</h1>
            <p>P≈ôipravte se na maturitu efektivnƒõ a z√°bavnƒõ.</p>

            <div class="dashboard"> <!-- Changed class to dashboard -->
                <div class="card" id="leaderboard-container" style="margin-top: 2rem;">
                    <div class="card-title">üèÜ T√Ωdenn√≠ ≈Ωeb≈ô√≠ƒçek (Top 10 podle XP)</div>
                    <ol id="leaderboard-list" style="list-style-position: inside; padding-left: 0;">
                        <!-- Leaderboard items generated by JS -->
                        <li class="no-leaderboard" style="text-align: center; color: #718096; list-style: none;">
                            Naƒç√≠t√°n√≠ ≈æeb≈ô√≠ƒçku...</li>
                    </ol>
                </div>
                <div id="activity-calendar" class="calendar">
                    <div class="calendar-header">
                        <button id="prev-month" type="button">‚Äπ</button> <!-- Added type -->
                        <h2 id="current-month"></h2>
                        <button id="next-month" type="button">‚Ä∫</button> <!-- Added type -->
                    </div>
                    <div id="calendar-grid" class="calendar-grid">
                        <!-- Calendar generated by JS -->
                    </div>
                    <div class="calendar-legend">
                        <p>Aktivita (testy za den):</p>
                        <ul>
                            <li><span class="legend-color activity-none"></span> 0</li>
                            <li><span class="legend-color activity-low"></span> 1-2</li>
                            <li><span class="legend-color activity-medium"></span> 3-4</li>
                            <li><span class="legend-color activity-high"></span> 5-6</li>
                            <li><span class="legend-color activity-very-high"></span> 7+</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2>Pokrok v p≈ôedmƒõtech</h2>
            <div class="subjects" id="subject-stats">
                <!-- Subject stats generated by JS -->
            </div>
        </section>

        <section id="test-section" style="display: none;">
            <div class="test-header">
                <div class="test-title">Test</div>
                <div>
                    <select id="subject-select" class="btn">
                        <option value="">Vyberte p≈ôedmƒõt</option>
                        <!-- Options populated by JS -->
                    </select>
                    <select id="topic-select" class="btn" disabled>
                        <option value="">Vyberte okruh</option>
                        <!-- Options populated by JS -->
                    </select>
                    <button id="toggle-favorite-btn" class="btn btn-secondary btn-favorite" style="display: none;"
                        title="Oznaƒçit/Odznaƒçit jako obl√≠ben√©">‚òÖ</button>
                    <button type="button" id="generate-test" class="btn btn-primary" disabled>Generovat test</button>
                    <!-- Added type -->
                    <!-- <div id="button-container"></div>  Removed this, buttons added directly -->
                </div>
            </div>
            <div id="test-container" class="test-container" style="display: none;">
                <!-- Test questions generated by JS -->
            </div>
            <p id="no-questions-message" style="display: none;">Pro dan√Ω p≈ôedmƒõt a okruh nejsou k dispozici ≈æ√°dn√©
                ot√°zky.</p>
        </section>
        <section id="profile-section" style="display: none;">
            <h1>M≈Øj Profil</h1>
        
            <!-- Account Info Card -->
            <div class="card">
                <div class="card-title">Informace o √∫ƒçtu</div>
                <p><strong>Email:</strong> <span id="profile-email">N/A</span></p>
                <p><strong>P≈ôezd√≠vka:</strong> <span id="profile-nickname">N/A</span></p>
                <p><strong>Datum registrace:</strong> <span id="profile-joined">N/A</span></p>
            </div>
        
            <!-- Change Nickname Card -->
            <div class="card card-compact" style="margin-top: 1.5rem;">
                <div class="card-title">Zmƒõnit P≈ôezd√≠vku</div>
                <!-- FORM with ID and content -->
                <form id="nickname-change-form">
                    <label for="new-nickname">Nov√° p≈ôezd√≠vka:</label>
                    <input type="text" id="new-nickname" required minlength="3" maxlength="15" pattern="[a-zA-Z0-9_]+">
                    <small style="display: block; margin-bottom: 1rem; font-size: 0.8em; color: #718096;">(3-15 znak≈Ø, pouze p√≠smena, ƒç√≠sla a podtr≈æ√≠tko)</small>
                    <button type="submit" id="change-nickname-btn" class="btn btn-primary">Ulo≈æit p≈ôezd√≠vku</button>
                    <p id="nickname-change-message" style="margin-top: 0.5rem;"></p>
                </form>
                <!-- END FORM -->
            </div>
        
            <!-- Change Password Card -->
            <div class="card card-compact" style="margin-top: 1.5rem;">
                <div class="card-title">Zmƒõnit Heslo</div>
                <!-- Content: Description, Button with ID, Message Area -->
                <p>Pro zmƒõnu hesla v√°m za≈°leme odkaz na v√°≈° email.</p>
                <button type="button" id="change-password-btn" class="btn btn-secondary">Zaslat odkaz pro zmƒõnu hesla</button>
                <p id="password-change-message" style="margin-top: 0.5rem;"></p>
                <!-- END Content -->
            </div>
        
            <!-- Delete Account Card -->
            <div class="card card-compact" style="margin-top: 1.5rem; border-color: var(--secondary);">
                 <div class="card-title" style="color: var(--secondary);">Smazat √∫ƒçet</div>
                 <!-- Content: Warning, Button with ID, Message Area -->
                 <p style="color: var(--secondary);">Tato akce je nevratn√° a sma≈æe v≈°echna va≈°e data!</p>
                 <button type="button" id="delete-account-btn" class="btn btn-danger">Smazat m≈Øj √∫ƒçet</button>
                 <p id="delete-account-message" style="margin-top: 0.5rem;"></p>
                 <!-- END Content -->
            </div>
        
            <!-- Separator -->
            <hr style="margin: 2rem 0; border: none; border-top: 1px solid var(--gray);">
            <h2>Statistiky & √öspƒõchy</h2>
            <!-- End Separator -->
        
            <!-- Moved Stats Content -->
            <div class="dashboard" id="profile-stats-dashboard">
                 <div class="card">
                     <div class="card-title">Denn√≠ S√©rie</div>
                     <div style="display: flex; align-items: center; justify-content: center;">
                         <span style="font-size: 2rem; margin-right: 0.5rem;">üî•</span>
                         <strong id="day-streak">0</strong> dn√≠
                     </div>
                 </div>
                 <div class="card">
                     <div class="card-title">Celkov√© XP</div>
                     <div style="display: flex; align-items: center; justify-content: center;">
                         <span style="font-size: 2rem; margin-right: 0.5rem;">‚ö°</span>
                         <strong id="total-xp">0</strong> XP
                     </div>
                 </div>
            </div>
        
            <div class="card" style="margin-top: 2rem;"> <!-- Achievements Card -->
                <div class="card-title">Moje √öspƒõchy</div>
                <ul id="achievement-list" class="achievement-container">
                     <!-- Achievement items generated by JS -->
                     <li class="no-achievements" style="display: none; text-align: center; color: #718096;">
                         Zat√≠m ≈æ√°dn√© √∫spƒõchy. Dokonƒçi nƒõjak√© testy!
                     </li>
                </ul>
            </div>
        
            <div class="card" style="margin-top: 2rem;"> <!-- Table Card -->
                <div class="card-title">Detailn√≠ statistiky podle p≈ôedmƒõtu</div>
                <table style="width: 100%; border-collapse: collapse;">
                     <thead>
                         <tr>
                             <th style="text-align: left; padding: 0.75rem;">P≈ôedmƒõt</th>
                             <th style="text-align: center; padding: 0.75rem;">Dokonƒçen√© testy</th>
                             <th style="text-align: center; padding: 0.75rem;">Spr√°vn√© odpovƒõdi</th>
                             <th style="text-align: center; padding: 0.75rem;">√öspƒõ≈°nost</th>
                         </tr>
                     </thead>
                     <tbody id="progress-table-body">
                         <!-- Progress Data generated by JS -->
                     </tbody>
                </table>
            </div>
            <!-- END Moved Stats Content -->
         </section>
    </main>

    <footer>
        <!-- Optional footer content -->
    </footer>

    <div id="test-completion-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">V√Ωsledek testu</div>
                <span class="close">√ó</span>
            </div>
            <div id="test-result">
                <p>Spr√°vn√© odpovƒõdi: <strong id="result-correct">0</strong> z <strong id="result-total">0</strong></p>
                <p>√öspƒõ≈°nost: <strong id="result-percentage">0%</strong></p>
            </div>
            <div style="text-align: center; margin-top: 1.5rem;">
                <button type="button" id="back-to-tests-modal" class="btn btn-primary">Zpƒõt na v√Ωbƒõr test≈Ø</button>
                <!-- Changed ID, added type -->
            </div>
        </div>
    </div>

    <!-- Firebase SDKs (Order matters!) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <!-- Your custom script - MUST be AFTER Firebase SDKs -->
    <script src="script.js"></script>
</body>

</html>